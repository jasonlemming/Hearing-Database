# Congressional Hearing Database - Daily Update Cron Configuration
#
# This file contains cron job configurations for automated daily updates.
# Copy the appropriate lines to your system's cron configuration.
#
# To install:
#   1. Edit the paths below to match your installation
#   2. Copy the desired cron line(s) to your crontab:
#      crontab -e
#   3. Add the line(s) and save
#
# To view current cron jobs:
#   crontab -l

# Set environment variables for cron jobs
# Note: Adjust these paths to match your installation
SHELL=/bin/bash
PATH=/usr/local/bin:/usr/bin:/bin
PROJECT_ROOT=/path/to/Congressional-meetings-api-claude-experiment

# Daily update at 2:00 AM (recommended for low API usage time)
# Adjust the path to match your actual installation directory
0 2 * * * cd /path/to/Congressional-meetings-api-claude-experiment && source venv/bin/activate && python scripts/daily_update.py --quiet >> logs/cron.log 2>&1

# Alternative: Daily update at 3:00 AM with 14-day lookback for more comprehensive updates
0 3 * * * cd /path/to/Congressional-meetings-api-claude-experiment && source venv/bin/activate && python scripts/daily_update.py --lookback-days 14 --quiet >> logs/cron.log 2>&1

# Weekly comprehensive update (Sundays at 1:00 AM) - more thorough check
0 1 * * 0 cd /path/to/Congressional-meetings-api-claude-experiment && source venv/bin/activate && python scripts/daily_update.py --lookback-days 30 >> logs/weekly_update.log 2>&1

# Monthly full data check (1st of each month at midnight)
0 0 1 * * cd /path/to/Congressional-meetings-api-claude-experiment && source venv/bin/activate && python scripts/daily_update.py --lookback-days 90 >> logs/monthly_update.log 2>&1

# Log rotation (weekly cleanup of old logs - keeps last 30 days)
0 4 * * 0 find /path/to/Congressional-meetings-api-claude-experiment/logs -name "*.log" -type f -mtime +30 -delete

# ============================================================================
# INSTALLATION INSTRUCTIONS
# ============================================================================
#
# 1. Replace /path/to/Congressional-meetings-api-claude-experiment with your actual project path
#
# 2. Ensure the following directories exist and are writable:
#    - logs/
#    - data/
#
# 3. Test the script manually before setting up cron:
#    cd /path/to/Congressional-meetings-api-claude-experiment
#    source venv/bin/activate
#    python scripts/daily_update.py --dry-run
#
# 4. Choose ONE of the daily update schedules above (2 AM or 3 AM recommended)
#
# 5. Optionally add the weekly/monthly updates for more comprehensive checks
#
# 6. Monitor the logs for the first few days:
#    tail -f logs/cron.log
#    tail -f logs/daily_update_YYYYMMDD.log
#
# ============================================================================
# TROUBLESHOOTING
# ============================================================================
#
# If cron jobs fail to run:
#   - Check cron daemon is running: sudo systemctl status cron
#   - Verify file paths are absolute and correct
#   - Ensure virtual environment exists and is activated
#   - Check file permissions on scripts and directories
#   - Test environment variables: env | grep PATH
#   - Check cron logs: grep CRON /var/log/syslog
#
# Common issues:
#   - PATH not set correctly in cron environment
#   - Virtual environment not activated
#   - Missing API key in environment
#   - Database file permissions
#   - Network connectivity issues
#
# For debugging, run the daily update manually:
#   cd /path/to/Congressional-meetings-api-claude-experiment
#   source venv/bin/activate
#   python scripts/daily_update.py --congress 119 --lookback-days 7
#